<!DOCTYPE html>
<html>
<head>
  <title>å††ã‚°ãƒ©ãƒ•ãƒ†ã‚¹ãƒˆ</title>
  <meta charset="utf-8">
  <style>
    body { background: #1a1a2e; color: white; padding: 20px; font-family: sans-serif; }
    .chartCanvas { 
      width: 160px; 
      height: 160px; 
      margin: 20px;
      border: 2px solid white;
    }
  </style>
</head>
<body>
  <h1>å††ã‚°ãƒ©ãƒ•æç”»ãƒ†ã‚¹ãƒˆ</h1>
  <div id="log"></div>
  <div id="container"></div>
  
  <script>
    function log(msg) {
      console.log(msg);
      document.getElementById('log').innerHTML += msg + '<br>';
    }
    
    function drawPieChart(canvas, value, label){
      log(`ğŸ¨ drawPieCharté–‹å§‹: label=${label}, value=${value}`);
      log(`  Canvas size: ${canvas.width}x${canvas.height}`);
      
      const ctx = canvas.getContext("2d");
      if (!ctx) {
        log("âŒ Canvas contextå–å¾—å¤±æ•—");
        return;
      }
      
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      const radius = Math.min(centerX, centerY) - 10;
      
      log(`  ä¸­å¿ƒ: (${centerX}, ${centerY}), åŠå¾„: ${radius}`);
      
      // èƒŒæ™¯å††
      ctx.beginPath();
      ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
      ctx.fillStyle = "rgba(255,255,255,.05)";
      ctx.fill();
      ctx.strokeStyle = "rgba(255,255,255,.15)";
      ctx.lineWidth = 2;
      ctx.stroke();
      
      // å€¤ã®å††ï¼ˆ0-100%ï¼‰
      const percentage = Math.min(Math.max(value, 0), 100) / 100;
      const endAngle = -Math.PI / 2 + (2 * Math.PI * percentage);
      
      log(`  ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸: ${percentage * 100}%, çµ‚äº†è§’åº¦: ${endAngle}`);
      
      ctx.beginPath();
      ctx.moveTo(centerX, centerY);
      ctx.arc(centerX, centerY, radius, -Math.PI / 2, endAngle);
      ctx.closePath();
      
      const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
      gradient.addColorStop(0, "rgba(124,77,255,.70)");
      gradient.addColorStop(1, "rgba(67,211,255,.70)");
      ctx.fillStyle = gradient;
      ctx.fill();
      
      // å€¤ãƒ†ã‚­ã‚¹ãƒˆ
      ctx.fillStyle = "#ffffff";
      ctx.font = "bold 28px sans-serif";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillText(Math.round(value), centerX, centerY);
      
      log(`âœ… drawPieChartå®Œäº†: ${label}`);
    }
    
    // ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
    log('ğŸ“Š ãƒ†ã‚¹ãƒˆé–‹å§‹');
    
    const container = document.getElementById('container');
    
    const charts = [
      {title: "ç†è«–åˆ†æ", value: 51, desc: "ãƒ†ã‚¹ãƒˆ1"},
      {title: "æŸ”è»Ÿé©å¿œ", value: 75, desc: "ãƒ†ã‚¹ãƒˆ2"},
      {title: "ç›´è¦³æ´å¯Ÿ", value: 30, desc: "ãƒ†ã‚¹ãƒˆ3"}
    ];
    
    charts.forEach((chart, index) => {
      log(`<br>ğŸ“ˆ Chart ${index + 1}: ${chart.title}`);
      
      const canvas = document.createElement("canvas");
      canvas.className = "chartCanvas";
      canvas.width = 200;
      canvas.height = 200;
      
      container.appendChild(canvas);
      
      drawPieChart(canvas, chart.value, chart.title);
    });
    
    log('<br>âœ… ã™ã¹ã¦ã®å††ã‚°ãƒ©ãƒ•ã®æç”»å®Œäº†');
  </script>
</body>
</html>
